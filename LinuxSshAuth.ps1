Select-String -Path ".\messages_sample.txt" -Pattern "(?<timestamp>[a-zA-Z]{3}\s+\d{1,2}\s+\d{2}:\d{2}:\d{2}).*?(?<status>accepted|failed)\s(?<method>publickey|password)\sfor\s(?<user>[a-zA-Z_\-0-9]+)" -AllMatches | ForEach-Object { $_.Matches | ForEach-Object { $timestamp=$_.Groups['timestamp'].Value; $status=$_.Groups['status'].Value; $method=$_.Groups['method'].Value; $user=$_.Groups['user'].Value }; [PSCustomObject]@{Timestamp=$timestamp;Status=$status;Method=$method;User=$user} } | Format-Table -AutoSize